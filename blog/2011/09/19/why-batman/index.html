
<!doctype html>
<!--[if lt IE 7]><html <?php language_attributes(); ?> class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html <?php language_attributes(); ?> class="no-js lt-ie9 lt-ie8"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html <?php language_attributes(); ?> class="no-js lt-ie9"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]-->
	<head>
		<meta charset="utf-8">
    <title>Why Batman? - Will You Harry Me</title>

		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  
  <link rel="canonical" href="http://harry.me/blog/2011/09/19/why-batman">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/assets/fonts/font-awesome.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Crimson+Text|Ubuntu:400,700" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
  <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css">
  <![endif]-->

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72"   href="/images/apple-touch-icon-72x72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">

  <script type="text/javascript" src="/javascripts/modernizr.custom.min.js"></script>
  <script type="text/javascript" src="/javascripts/jquery-1.9.1.min.js"></script>
  <script type="text/javascript" src="/javascripts/jquery.imagesloaded.min.js"></script>

  
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-15787846-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
  <script type="text/javascript">
    var Harry = {};
  </script>
	</head>


<body class="blog ">
  <div id="container">
    <header class="header" role="banner">
      <div id="inner-header" class="wrap clearfix">
        <div class="logo">
          <h1><a href="/" rel="nofollow">Will You Harry Me?</a></h1>
        </div>

        <div class="menu">
          <nav role="navigation">
            <a class="toggleMenu" href="#" style="display: inline-block;"><i class="icon-reorder"></i></a>
            <ul id="menu-main" class="nav top-nav clearfix">
              <li class="menu-item menu-item-home"><a href="/">Home</a></li>
              <li class="menu-item"><a href="/about/">About</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    
<div id="featured-wrap">
  <img src="/images/headers/batman.jpg" class="attachment-creer-full wp-post-image" />
  <div class="feature-credit">photo credit: Carter Brundage</div>
</div>



<div id="content" class="single">
  <div id="inner-content" class="wrap clearfix">
    <div id="main" class="twelvecol clearfix" role="main">
      <article class="clearfix post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
        <header class="article-header pushfourcol">
          <span class="published">








  




<time datetime="2011-09-19T12:41:00-04:00" pubdate data-updated="true">Sep 19<span>th</span>, 2011</time></span>
          <h1 class="entry-title single-title" itemprop="headline">Why Batman?</h1>
        </header>

        <section class="entry-content clearfix" itemprop="articleBody">
          <div id="postmeta" class="fourcol first clearfix">
            <p class="byline vcard">

            <span class="byline author vcard">
                
                  
                
                By <a href="/about/" rel="author">Harry Brundage</a>
              </span>

              
              
              
                

<span class="categories">
  Concerning: 
  
    <a class='category' href='/blog/categories/neat-algos/'>neat algos</a>
  
</span>


              
              <span class="count">Words: <strong>1590</strong></span>
              </p>

            
              <p class="share">
  
  <span class="facebook">
    <span class="facebook"><a href="http://www.facebook.com/sharer.php?u=http://harry.me/blog/2011/09/19/why-batman/&t=Why Batman?" target="blank"><i class="icon-facebook"></i></a>
  </span>
  
  
  <span class="twitter">
    <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://harry.me/blog/2011/09/19/why-batman/" data-via="harrybrundage" data-counturl="http://harry.me/blog/2011/09/19/why-batman/" ><i class="icon-twitter"></i></a>
  </span>
  
</p>

            
          </div>

          <div id="post-content">
            <p><a href="http://batmanjs.org/">Batman.js</a> is <a href="http://shopify.com">Shopify</a>&#8217;s new open source CoffeeScript framework, and I&#8217;m absolutely elated to introduce it to the world after spending so much time on it. Find Batman on GitHub <a href="https://github.com/Shopify/batman">here</a>.</p>

<p>Batman emerges into a world populated with extraordinary frameworks being used to great effect. With the incredible stuff being pushed out in projects like <a href="http://www.sproutcore.com/about/">Sproutcore 2.0</a> and <a href="http://documentcloud.github.com/backbone/">Backbone.js</a>, how is a developer to know what to use when? There&#8217;s only so much time to play with cool new stuff, so I&#8217;d like to give a quick tour of what makes Batman different and why you might want to use it instead of the other amazing frameworks available today.</p>

<!--more-->


<h2>Batman makes building apps easy</h2>

<p>Batman is a framework for building single page applications. It&#8217;s not a progressive enhancement or a single purpose DOM or AJAX library. It&#8217;s built from the ground up to make building awesome single page apps by implementing all the lame parts of development like cross browser compatibility, data transport, validation, custom events, and a whole lot more. We provide handy helpers for development to generate and serve code, a recommended app structure for helping you organize code and call it when necessary, a full MVC stack, and a bunch of extras, all while remaining less than 18k when gzipped. Batman doesn&#8217;t provide the basics, or the whole kitchen sink, but a fluid API that allows you to write the important code for your app and none of the boilerplate.</p>

<h2>A super duper runtime</h2>

<p>At the heart of Batman is a runtime layer used for manipulating data from objects and subscribing to events objects may emit. Batman&#8217;s runtime is used similarly to SproutCore&#8217;s or Backbone&#8217;s in that all property access and assignment on Batman objects must be done through <code>someObject.get</code> and <code>someObject.set</code>, instead of using standard dot notation like you might in vanilla JavaScript. Adhering to this property system allows you to:</p>

<ul>
<li>transparently access &#8220;deep&#8221; properties which may be simple data or computed by a function,</li>
<li>inherit said computed properties from objects in the prototype chain,</li>
<li>subscribe to events like <code>change</code> or <code>ready</code> on other objects at &#8220;deep&#8221; keypaths,</li>
<li>and most importantly, dependencies can be tracked between said properties, so chained observers can be fired and computations can be cached while guaranteed to be up-to-date.</li>
</ul>


<p>All this comes free with every Batman object, and they still play nice with vanilla JavaScript objects. Let&#8217;s explore some of the things you can do with the runtime. Properties on objects can be observed using <code>Batman.Object::observe</code>:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">crimeReport = </span><span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span>
</span><span class='line'><span class="nx">crimeReport</span><span class="p">.</span><span class="nx">observe</span> <span class="s">&#39;address&#39;</span><span class="p">,</span> <span class="nf">(newValue) -&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">DangerTracker</span><span class="p">.</span><span class="nx">isDangerous</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">crimeReport</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;currentTeam&#39;</span><span class="p">).</span><span class="nx">warnOfDanger</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>This kind of stuff is available in Backbone and SproutCore both, however we&#8217;ve tried to bring something we missed in those frameworks to Batman: &#8220;deep&#8221; keypaths. In Batman, any keypath you supply can traverse a chain of objects by separating the keys by a <code>.</code> (dot). For example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">batWatch = </span><span class="nx">Batman</span>
</span><span class='line'>  <span class="nv">currentCrimeReport: </span><span class="nx">Batman</span>
</span><span class='line'>    <span class="nv">address: </span><span class="nx">Batman</span>
</span><span class='line'>      <span class="nv">number: </span><span class="s">&quot;123&quot;</span>
</span><span class='line'>      <span class="nv">street: </span><span class="s">&quot;Easy St&quot;</span>
</span><span class='line'>      <span class="nv">city: </span><span class="s">&quot;Gotham&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;currentCrimeReport.address.number&#39;</span> <span class="c1">#=&gt; &quot;123&quot;</span>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">set</span> <span class="s">&#39;currentCrimeReport.address.number&#39;</span><span class="p">,</span> <span class="s">&quot;461A&quot;</span>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;currentCrimeReport.address.number&#39;</span> <span class="c1">#=&gt; &quot;461A&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This works for observation too:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">observe</span> <span class="s">&#39;currentCrimeReport.address.street&#39;</span><span class="p">,</span> <span class="nf">(newStreet, oldStreet) -&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">DistanceCalculator</span><span class="p">.</span><span class="nx">travelTime</span><span class="p">(</span><span class="nx">newStreet</span><span class="p">,</span> <span class="nx">oldStreet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000</span>
</span><span class='line'>    <span class="nx">BatMobile</span><span class="p">.</span><span class="nx">bringTo</span><span class="p">(</span><span class="nx">batWatch</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;currentLocation&#39;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>The craziest part of the whole thing is that these observers will always fire with the value of whatever is at that keypath, even if intermediate parts of the keypath change.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">crimeReportA = </span><span class="nx">Batman</span>
</span><span class='line'>  <span class="nv">address: </span><span class="nx">Batman</span>
</span><span class='line'>    <span class="nv">number: </span><span class="s">&quot;123&quot;</span>
</span><span class='line'>    <span class="nv">street: </span><span class="s">&quot;Easy St&quot;</span>
</span><span class='line'>    <span class="nv">city: </span><span class="s">&quot;Gotham&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">crimeReportB = </span><span class="nx">Batman</span>
</span><span class='line'>  <span class="nv">address: </span><span class="nx">Batman</span>
</span><span class='line'>    <span class="nv">number: </span><span class="s">&quot;72&quot;</span>
</span><span class='line'>    <span class="nv">street: </span><span class="s">&quot;Jolly Ln&quot;</span>
</span><span class='line'>    <span class="nv">city: </span><span class="s">&quot;Gotham&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">batWatch = </span><span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">({</span><span class="nv">currentCrimeReport: </span><span class="nx">crimeReportA</span><span class="p">})</span>
</span><span class='line'>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;currentCrimeReport.address.street&#39;</span><span class="p">)</span> <span class="c1">#=&gt; &quot;East St&quot;</span>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">observe</span> <span class="s">&#39;currentCrimeReport.address.street&#39;</span><span class="p">,</span> <span class="nf">(newStreet) -&gt;</span>
</span><span class='line'>  <span class="nx">MuggingWatcher</span><span class="p">.</span><span class="nx">checkStreet</span><span class="p">(</span><span class="nx">newStreet</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nx">batWatch</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;currentCrimeReport&#39;</span><span class="p">,</span> <span class="nx">crimeReportB</span><span class="p">)</span>
</span><span class='line'><span class="c1"># the &quot;MuggingWatcher&quot; callback above will have been called with &quot;Jolly Ln&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice what happened? Even though the middle segment of the keypath changed (a whole new <code>crimeReport</code> object was introduced), the observer fires with the new deep value. This works with arbitrary length keypaths as well as intermingled <code>undefined</code> values.</p>

<p>The second neat part of the runtime is that because all access is done through <code>get</code> and <code>set</code>, we can track dependencies between object properties which need to be computed. Batman calls these functions <code>accessors</code>, and using the CoffeeScript executable class bodies they are really easy to define:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="k">class</span> <span class="nx">BatWatch</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span>
</span><span class='line'>  <span class="c1"># Define an accessor for the `currentDestination` key on instances of the BatWatch class.</span>
</span><span class='line'>  <span class="nx">@accessor</span> <span class="s">&#39;currentDestination&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nv">address = </span><span class="nx">@get</span> <span class="s">&#39;currentCrimeReport.address&#39;</span>
</span><span class='line'>    <span class="k">return</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">address</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;number&#39;</span><span class="p">)</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">address</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;street&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">address</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;city&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">crimeReport = </span><span class="nx">Batman</span>
</span><span class='line'>  <span class="nv">address: </span><span class="nx">Batman</span>
</span><span class='line'>    <span class="nv">number: </span><span class="s">&quot;123&quot;</span>
</span><span class='line'>    <span class="nx">street</span> <span class="s">&quot;Easy St&quot;</span>
</span><span class='line'>    <span class="nv">city: </span><span class="s">&quot;Gotham&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">watch = </span><span class="k">new</span> <span class="nx">BatWatch</span><span class="p">(</span><span class="nv">currentCrimeReport: </span><span class="nx">crimeReport</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nx">watch</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;currentDestination&#39;</span><span class="p">)</span> <span class="c1">#=&gt; &quot;123 Easy St, Gotham&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Importantly, the observers you may attach to these computed properties will fire as soon as you update their dependencies:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">watch</span><span class="p">.</span><span class="nx">observe</span> <span class="s">&#39;currentDestination&#39;</span><span class="p">,</span> <span class="nf">(newDestination) -&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">newDestination</span>
</span><span class='line'><span class="nx">crimeReport</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s">&#39;address.number&#39;</span><span class="p">,</span> <span class="s">&quot;124&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1"># &quot;124 Easy St, Gotham&quot; will have been logged to the console</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can also define the default accessors which the runtime will fall back on if an object doesn&#8217;t already have an accessor defined for the key being <code>get</code>ted or <code>set</code>ted.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">jokerSimulator = </span><span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span>
</span><span class='line'><span class="nx">jokerSimulator</span><span class="p">.</span><span class="nx">accessor</span> <span class="nf">(key) -&gt;</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">key</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="si">}</span><span class="s">, HA HA HA!&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">jokerSimulator</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;why so serious&quot;</span><span class="p">)</span> <span class="c1">#=&gt; &quot;WHY SO SERIOUS, HA HA HA!&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This feature is useful when you want to present a standard interface to an object, but work with the data in nontrivial ways underneath. For example, <code>Batman.Hash</code> uses this to present an API similar to a standard JavaScript object, while emitting events and allowing objects to be used as keys.</p>

<h2>What&#8217;s it useful for?</h2>

<p>The core of Batman as explained above makes it possible to know when data changes as soon as it happens. This is ideal for something like client side views. They&#8217;re no longer static bundles of HTML that get cobbled together as a long string and sent to the client, they are long lived representations of data which need to change as the data does. Batman comes bundled with a view system which leverages the abilities of the property system.</p>

<p>A simplified version of the view for <a href="http://batmanjs.org/examples/alfred.html">Alfred</a>, Batman&#8217;s todo manager example application, lies below:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;h1&gt;</span>Alfred<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;items&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span> <span class="na">data-mixin=</span><span class="s">&quot;animation&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.isDone&quot;</span> <span class="na">data-event-change=</span><span class="s">&quot;todo.save&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>        <span class="nt">&lt;label</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span> <span class="na">data-addclass-done=</span><span class="s">&quot;todo.isDone&quot;</span> <span class="na">data-mixin=</span><span class="s">&quot;editable&quot;</span><span class="nt">&gt;&lt;/label&gt;</span>
</span><span class='line'>        <span class="nt">&lt;a</span> <span class="na">data-event-click=</span><span class="s">&quot;todo.destroy&quot;</span><span class="nt">&gt;</span>delete<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li&gt;&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;Todo.all.length&quot;</span><span class="nt">&gt;&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;&#39;item&#39; | pluralize Todo.all.length&quot;</span><span class="nt">&gt;&lt;/span&gt;&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;form</span> <span class="na">data-formfor-todo=</span><span class="s">&quot;controllers.todos.emptyTodo&quot;</span> <span class="na">data-event-submit=</span><span class="s">&quot;controllers.todos.create&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;new-item&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;add a todo item&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/form&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We sacrifice any sort of transpiler layer (no HAML), and any sort of template layer (no Eco, jade, or mustache). Our views are valid HTML5, rendered by the browser as soon as they have been downloaded. They aren&#8217;t JavaScript strings, they are valid DOM trees which Batman traverses and populates with data without any compilation or string manipulation involved. The best part is that Batman &#8220;binds&#8221; a node&#8217;s value by observing the value using the runtime as presented above. When the value changes in JavaScript land, the corresponding node attribute(s) bound to it update automatically, and the user sees the change. Vice versa remains true: when a user types into an input or checks a checkbox, the string or boolean is set on the bound object in JavaScript. The concept of bindings isn&#8217;t new, as you may have seen it in things like Cocoa, or in <a href="http://knockoutjs.com/">Knockout</a> or Sproutcore in JS land.</p>

<p>We chose to use bindings because we a) don&#8217;t want to have to manually check for changes to our data, and b) don&#8217;t want to have to re-render a whole template every time one piece of data changes. With mustache or <code>jQuery.tmpl</code> and company, I end up doing both those things surprisingly often. It seems wasteful to re-render every element in a loop and pay the penalty for appending all those nodes, when only one key on one element changes, and we could just update that one node. SproutCore&#8217;s &#8216;SC.TemplateView&#8217; with Yehuda Katz&#8217; <a href="http://www.handlebarsjs.com/">Handlebars.js</a> do a good job of mitigating this, but we still didn&#8217;t want to do all the string ops in the browser, and so we opted for the surgical precision of binding all the data in the view to exactly the properties we want.</p>

<p>What you end up with is a fast render with no initial loading screen, at the expense of the usual level of complex logic in your views. Batman&#8217;s view engine provides conditional branching, looping, context, and simple transforms, but thats about it. It forces you to write any complex interaction code in a packaged and reusable <code>Batman.View</code> subclass, and leave the HTML rendering to the thing that does it the best: the browser.</p>

<h2>More?</h2>

<p>Batman does more than this fancy deep keypath stuff and these weird HTML views-but-not-templates. We have a routing system for linking from quasi-page to quasi-page, complete with named segments and GET variables. We have a <code>Batman.Model</code> layer for retrieving and sending data to and from a server which works out of the box with storage backends like Rails and <code>localStorage</code>.  We have other handy mixins for use in your own objects like <code>Batman.StateMachine</code> and <code>Batman.EventEmitter</code>. And, we have a lot more on the ay. I strongly encourage you to check out the <a href="http://batmanjs.org/">project website</a>, the <a href="https://github.com/Shopify/batman">source on GitHub</a>, or visit us in <a href="irc://freenode.net/batmanjs">#batmanjs on freenode</a>. Any questions, feedback, or patches will be super welcome, and we&#8217;re always open to suggestions on how we can make Batman better for you.</p>

<p>Until next time&#8230;.</p>

<iframe width="560" height="345" src="http://www.youtube.com/embed/X0UJaprpxrk" frameborder="0" allowfullscreen></iframe>




<br/>


<p><em>This article has been crossposted to the <a href="http://www.shopify.com/">Shopify</a> Technology blog <a href="http://www.shopify.com/technology/4080092-how-batman-can-help-you-build-app">here</a>.</em></p>

          </div>
        </section>

        <footer class="article-footer clearfix">
          <nav id="post-entries" class="clearfix">
            
            <div class="nav-prev fl">
              <a rel="prev" href="/blog/2011/07/05/neat-algorithms-harmony-search/" title="Previous Post: Neat Algorithms - Harmony Search">
                <span class="meta">Previous</span>
                <span class="link">Neat Algorithms - Harmony Search</span>
              </a>
            </div>
            
            
            <div class="nav-next fr">
              <a rel="next" href="/blog/2012/01/22/javascript-documentation-sucks/" title="Next Post: JavaScript Documentation Sucks">
                <span class="meta">Next</span>
                <span class="link">JavaScript Documentation Sucks</span>
              </a>
            </div>
            
          </nav>
        </footer>

        

        <div class="eightcol last clearfix">
          
        </div>
      </article> <!-- end article -->
    </div>
  </div> <!-- end #inner-content -->
</div> <!-- end #content -->


    <footer class="footer" role="contentinfo">
    <div id="inner-footer" class="wrap clearfix">
      <nav role="navigation">
        <ul id="menu-footer" class="nav footer-nav clearfix">
          <li class="menu-item"><a href="/">Home</a></li>
          <li class="menu-item"><a href="/about/">About</a></li>
          <li class="menu-item"><a href="/archives">Archives</a></li>
          <li class="menu-item"><a href="mailto:harry@harry.me">Contact</a></li>
        </ul>
      </nav>
    </div>
  </footer>
</div>

<a href="#" id="back-to-top"><i class="icon-angle-up"></i></a>
<script type="text/javascript" src="/javascripts/jquery.fitvids.js"></script>
<script type="text/javascript" src="/javascripts/scripts.js"></script>
<script type="text/javascript" src="/javascripts/nav.js"></script>
<script type="text/javascript" src="/javascripts/jquery.infinitescroll.min.js"></script>



</body>
</html>

